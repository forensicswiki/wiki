
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Superfetch - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#components" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Superfetch
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../community/" class="md-tabs__link">
          
  
  
  Community

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributions_mediawiki/" class="md-tabs__link">
          
  
  
  Contributions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tags/" class="md-tabs__link">
          
  
  
  Tags

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contributions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributions Mediawiki
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    <span class="md-ellipsis">
      Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#robust-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Robust performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Scenarios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scenarios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cold-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Cold scenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warm-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Warm scenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Performance scenarios
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-formats" class="md-nav__link">
    <span class="md-ellipsis">
      File Formats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-links" class="md-nav__link">
    <span class="md-ellipsis">
      External Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-source" class="md-nav__link">
    <span class="md-ellipsis">
      Open Source
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../tags/#tag:articles-that-need-to-be-expanded" class="md-tag">Articles that need to be expanded</a>
      
    
      
      
      
        <a href="../tags/#tag:windows" class="md-tag">Windows</a>
      
    
  </nav>



  <h1>Superfetch</h1>

<p>SuperFetch is a performance enhancement introduced in
<a href="../microsoft/">Microsoft</a> <a href="../windows/">Windows Vista</a> to
reduce the time necessary to launch applications. SuperFetch works with
the memory manager service in Windows to analyze memory usage patterns
over time to determine the optimal memory content for a given user for a
date or time of day. This differs from the
<a href="../prefetch/">Prefetch</a> technique used in Microsoft Windows XP,
which preloads data into memory without analyzing usage patterns.</p>
<p>From <a href="https://download.microsoft.com/download/3/0/2/3027d574-c433-412a-a8b6-5e0a75d5b237/perfaccel.docx">Windows ReadyBoost</a>:</p>
<p>SuperFetch prioritizes the following kinds of pages to remain in memory:</p>
<ul>
<li>Pages of applications that are used most frequently overall.</li>
<li>Pages of applications that are commonly used when resuming:</li>
<li>After extensive hibernation (for example, first thing in the
    morning).</li>
<li>After shorter periods of sleep or hibernation (for example, after
    lunch).</li>
</ul>
<p>Prefetched pages are added to the system’s standby page list, which has
been reorganized and redesigned to retain useful data in memory over
longer periods of time.</p>
<p>If SuperFetch detects that the system drive is a fast SSD (as measured
by Windows Experience Index Disk score), then SuperFetch turns off
<a href="../readyboot/">ReadyBoot</a>, <a href="../readyboost/">ReadyBoost</a>,
and the SuperFetch service itself.</p>
<p>To calculate the Windows Experience Index Disk score run:</p>
<pre><code>winsat formal
</code></pre>
<h2 id="components">Components</h2>
<h3 id="robust-performance">Robust performance</h3>
<p>Robust performance (or robustness) is a component of SuperFetch to watch
for specific file I/O access that might harm system performance by
populating the standby lists with unneeded data.</p>
<h2 id="scenarios">Scenarios</h2>
<p>SuperFetch distinguishes between different scenarios to accurately
measure performance.</p>
<h3 id="cold-scenario">Cold scenario</h3>
<p>In a cold scenario, the test applications are not already in memory when
the test begins. Cold scenarios measure performance either after a state
transition, such as boot or resume from hibernation, or after another
application claims most of the available memory, such as after launching
and quitting a game.</p>
<h3 id="warm-scenario">Warm scenario</h3>
<p>In a warm scenario, some or all the scenario contents are in memory
before measurement. This usually means that the test has run at least
once during this logon session.</p>
<h3 id="performance-scenarios">Performance scenarios</h3>
<p>Performance scenarios defined by the Windows Performance Recorder (WPR):</p>
<ul>
<li>General: Records general performance while the computer is running.</li>
<li>On/Off - Boot: Records performance while the computer is booting.</li>
<li>On/Off – Fast Startup: Records performance during a fast startup.</li>
<li>On/Off - Shutdown: Records performance while shutting the computer
  down.</li>
<li>On/Off - RebootCycle: Records performance during the entire cycle
  while the computer is rebooting.</li>
<li>On/Off - Standby/Resume: Records performance when the computer is
  placed on standby and then resumed.</li>
<li>On/Off - Hibernate/Resume: Records performance when the computer is
  placed in hibernation and then resumed.</li>
</ul>
<p>Where "On/Off" likely refers to a cold scenario.</p>
<h2 id="configuration">Configuration</h2>
<p>Because SuperFetch appears to leave a system with no available memory, some
users turn it off to create the appearance of having more free memory. The
feature can be configured by changing the <a href="../windows_registry/">Registry</a> value:</p>
<pre><code>Key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters
Value: EnableSuperfetch
</code></pre>
<p>A value of zero disables SuperFetch, one enables it for booting only,
two for applications, and three for both applications and boot. This
setting can also be changed using the Services console, <code>services.msc</code>
<a href="https://tiredblogger.wordpress.com/2007/03/27/superfetch-not-so-super-for-gaming/">1</a>.</p>
<h2 id="file-formats">File Formats</h2>
<p>Data for SuperFetch is gathered by the
<code>%SystemRoot%\System32\Sysmain.dll</code>, part of the Service Host process,
<code>%SystemRoot%\System32\Svchost.exe</code>, and stored in a series of files in
the <code>%SystemRoot%\Prefetch</code> directory
<a href="https://learn.microsoft.com/en-us/">2</a>.
These files appear to start with the prefix <code>Ag</code> and have a <code>.db</code>
extension. Note that there are likely more SuperFetch database files
named differently, presumably all using the .db extension.</p>
<p>The format of the SuperFetch database files is not fully known, there is
available unofficial partial specification
<a href="http://blog.rewolf.pl/blog/?p=214">3</a> and open source (GPL) dumper for
.db files <a href="https://github.com/rwfpl/rewolf-superfetch-dumper">4</a>. For
more information see <a href="../windows_superfetch_format/">SuperFetch
Format</a>.</p>
<p>The SuperFetch feature is seeded with some basic usage patterns when the
operating system is installed
<a href="https://learn.microsoft.com/en-us/shows/">5</a>.</p>
<p>The SuperFetch service is managed by the File Information FS MiniFilter
service. It appears that most of the SuperFetch database files are
updated (written) when the service is shut down. AgAppLaunch.db is also
written when the service starts.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../prefetch/">Prefetch</a></li>
<li><a href="../readyboost/">ReadyBoost</a></li>
<li><a href="../readyboot/">ReadyBoot</a></li>
<li><a href="../windows_superfetch_format/">SuperFetch Format</a></li>
<li><a href="../windows/">Windows</a></li>
</ul>
<h2 id="external-links">External Links</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/technet-magazine/cc162480(v=msdn.10)">Inside the Windows Vista Kernel: Part 2</a>,
  by <a href="../mark_russinovich/">Mark Russinovich</a>, March 2007</li>
<li><a href="https://download.microsoft.com/download/7/E/7/7E7662CF-CBEA-470B-A97E-CE7CE0D98DC2/Win7Perf.docx">Performance Testing Guide for Windows</a>,
  by <a href="../microsoft/">Microsoft</a>, August 18, 2009 </li>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh162965(v=win.10)">Performance Scenarios</a>,
  by <a href="../microsoft/">Microsoft</a>, October 20, 2013</li>
<li><a href="https://en.wikipedia.org/wiki/Windows_Vista_I/O_technologies#SuperFetch">Wikipedia: Windows Vista I/O technologies - SuperFetch</a></li>
<li><a href="https://learn.microsoft.com/en-us/shows/">Channel 9 Interview with Michael Fortin of Microsoft on SuperFetch</a></li>
<li><a href="https://www.informationweek.com">Microsoft Predicts The Future With Vista's SuperFetch</a>
  from Information Week</li>
</ul>
<h2 id="tools">Tools</h2>
<h3 id="open-source">Open Source</h3>
<ul>
<li><a href="https://github.com/rwfpl/rewolf-superfetch-dumper">rewolf-superfetch-dumper</a></li>
<li><a href="https://www.crowdstrike.com/resources/community-tools/crowdresponse/">CrowdResponse</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>