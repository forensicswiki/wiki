
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Determining os version from an evidence image - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#windows" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Determining os version from an evidence image
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../community/" class="md-tabs__link">
          
  
  
  Community

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributions_mediawiki/" class="md-tabs__link">
          
  
  
  Contributions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tags/" class="md-tabs__link">
          
  
  
  Tags

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contributions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributions Mediawiki
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    <span class="md-ellipsis">
      Windows
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-9598me" class="md-nav__link">
    <span class="md-ellipsis">
      Windows 95/98/ME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-nt4" class="md-nav__link">
    <span class="md-ellipsis">
      Windows NT4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-2000-xp-2003-vista" class="md-nav__link">
    <span class="md-ellipsis">
      Windows 2000, XP, 2003, Vista
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    <span class="md-ellipsis">
      Other
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unixlinux" class="md-nav__link">
    <span class="md-ellipsis">
      Unix/Linux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unix/Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-solaris" class="md-nav__link">
    <span class="md-ellipsis">
      (Open) Solaris
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freenetopenbsd" class="md-nav__link">
    <span class="md-ellipsis">
      Free/Net/OpenBSD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aix" class="md-nav__link">
    <span class="md-ellipsis">
      AIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hpux" class="md-nav__link">
    <span class="md-ellipsis">
      HP/UX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other_1" class="md-nav__link">
    <span class="md-ellipsis">
      Other
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other_2" class="md-nav__link">
    <span class="md-ellipsis">
      Other
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../tags/#tag:howtos" class="md-tag">Howtos</a>
      
    
  </nav>



  <h1>Determining os version from an evidence image</h1>

<p>One of the first steps an examiners will need to carry out once they
have an evidence image is to log system metadata, including OS version
and patch level. This may be of particular importance if the image in
question is from a machine that is suspected of having been compromised.</p>
<h2 id="windows">Windows</h2>
<h3 id="windows-9598me">Windows 95/98/ME</h3>
<p>Establish the boot volume, verify that it is a FAT file system, and
locate the hidden text file \MSDOS.SYS. Locate the [Options]WinVer
parameter:</p>
<table>
<thead>
<tr>
<th>WinVer</th>
<th>OS</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.00.0950</td>
<td>Windows 95</td>
</tr>
<tr>
<td>4.00.1111</td>
<td>Windows 95 OSR2</td>
</tr>
<tr>
<td>4.03.1212</td>
<td>Windows 95 OSR2.1</td>
</tr>
<tr>
<td>4.03.1214</td>
<td>Windows 95 OSR2.5</td>
</tr>
<tr>
<td>4.10.1998</td>
<td>Windows 98</td>
</tr>
<tr>
<td>4.10.2222</td>
<td>Windows 98 SE</td>
</tr>
<tr>
<td>4.90.3000</td>
<td>Windows ME</td>
</tr>
</tbody>
</table>
<p>Alternatively, establish WinDir ([Paths]WinDir in \MSDOS.SYS), locate
the %WINDIR%\SYSTEM.DAT registry file. Next, look up the registry key
Software\Microsoft\Windows\CurrentVersion\, and values Version and
VersionNumber. (Backup copies of SYSTEM.DAT may be found in .CAB files
in %WINDIR%\SYSBCKUP.)</p>
<h3 id="windows-nt4">Windows NT4</h3>
<h3 id="windows-2000-xp-2003-vista">Windows 2000, XP, 2003, Vista</h3>
<p>Information about a running system can be displayed using the command
`ver` (and `systeminfo` on some systems).</p>
<p>During a forensic examination, information regarding the version of
Windows can be found in a number of places. For example, by default, the
Windows directory on Windows XP is "C:\Windows", where on Windows NT and
2000, it was "C:\Winnt". This is not definitive, however, because this
directory name is easily modified during installation.</p>
<p>Determining the version of Windows from the Software Registry Hive
file - navigate to the <em>Microsoft\Windows NT\CurrentVersion</em> key, and
examine the values beneath the key; specifically, values such as
ProductName, CSDVersion, ProductId (if available), BuildLab, and on
Vista, BuildLabEx.</p>
<p>Determining the version of Windows from file version information -
locate the file %WinDir%\system32\ntoskrnl.exe and review the file
version information/strings from the resource section of the PE file.
You can view this information with a hex editor, or extract it using a
variety of means. There is a Perl module (<code>Win32::File::VersionInfo</code>)
that will allow you to extract this information, and the Perl script
<a href="https://sourceforge.net/projects/windowsir/files/OS%20Detect/">kern.pl</a>
illustrates a platform independent means of examining the PE header and
ultimately locating the file version information.</p>
<p>In order to determine the difference between Windows XP Professional and
Home versions, look for the %WinDir%\system32\prodspec.ini file; it
contains information regarding the Product type (either XP Pro or Home).
Another way to do this is to look at Microsoft Product Code (first 5
digits of <em>Product ID</em>). Some of these values:</p>
<table>
<thead>
<tr>
<th>Value (MPC)</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>55034</td>
<td>Windows XP Professional English</td>
</tr>
<tr>
<td>55683</td>
<td>Windows XP Professional Russian</td>
</tr>
<tr>
<td>55681</td>
<td>Windows XP Home Edition Russian</td>
</tr>
</tbody>
</table>
<h3 id="other">Other</h3>
<ul>
<li>Windows 2008</li>
<li>Windows 7</li>
<li>Windows 8</li>
<li>Windows CE, Mobile</li>
</ul>
<p>Different editions per version?</p>
<h2 id="unixlinux">Unix/Linux</h2>
<p>Information about a running system, including the kernel version, can be
displayed using the command `uname -a`. However, this is not much good
if you performing dead analysis on a disk image.</p>
<h3 id="linux">Linux</h3>
<p>A number of Linux distributions create a file in <em>/etc</em> to identify the
release or version installed.</p>
<pre><code>/etc/issue
/etc/issue.net
</code></pre>
<table>
<thead>
<tr>
<th>Distro</th>
<th>Tag</th>
</tr>
</thead>
<tbody>
<tr>
<td>Red Hat</td>
<td>/etc/redhat-release</td>
</tr>
<tr>
<td>Debian</td>
<td>/etc/debian-version</td>
</tr>
</tbody>
</table>
<h3 id="open-solaris">(Open) Solaris</h3>
<h3 id="freenetopenbsd">Free/Net/OpenBSD</h3>
<p>A first indicator of the presence of a BSDs operating system is the
partition table on a MBR-partitioned disk:</p>
<table>
<thead>
<tr>
<th>OS</th>
<th>Partition type</th>
</tr>
</thead>
<tbody>
<tr>
<td>FreeBSD</td>
<td>FreeBSD (0xA5)</td>
</tr>
<tr>
<td>OpenBSD</td>
<td>OpenBSD (0xA6)</td>
</tr>
<tr>
<td>NetBSD</td>
<td>NetBSD (0xA9)</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>You can get the release and version of BSDs operating system inside the
kernel images, even with only a disk image.</p>
<table>
<thead>
<tr>
<th>OS</th>
<th>Kernel path</th>
</tr>
</thead>
<tbody>
<tr>
<td>FreeBSD</td>
<td>/boot/kernel/kernel</td>
</tr>
<tr>
<td>OpenBSD</td>
<td>/bsd</td>
</tr>
<tr>
<td>NetBSD</td>
<td>/netbsd</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>You can use <code>strings</code> and <code>grep</code> tools to find this information with
<code>strings kernel_path | grep os_name</code>. (e.g.:
<code>strings /bsd | grep OpenBSD</code>)</p>
<h3 id="aix">AIX</h3>
<h3 id="hpux">HP/UX</h3>
<h3 id="other_1">Other</h3>
<ul>
<li>BSDI</li>
</ul>
<h2 id="other_2">Other</h2>
<ul>
<li>Plan9</li>
<li>QNX RTOS</li>
<li>OS2</li>
<li>MacOS-X/IOS</li>
<li>DOS</li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>